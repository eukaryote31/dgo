package dgo.policy;

import java.util.Arrays;

import dgo.model.Goban;
import dgo.model.GobanValuesD;

public class SimplePolicy implements PolicyComponent {
	// A precomputed map of importance on the board. Also happens to encourage
	// tenuki by increasing the scores of unoccupied corners.
	private static final GobanValuesD MAP = new GobanValuesD(new double[] {
			0.26727631354556,
			0.48594673936919325,
			0.4748859553758278,
			0.506842212915054,
			0.506439010502337,
			0.495178732396478,
			0.45326602439382846,
			0.4441263995991192,
			0.4042856849401735,
			0.36991009756090104,
			0.3616020187273444,
			0.36978914928926016,
			0.36369625712544423,
			0.38111350165546715,
			0.4040216497400449,
			0.4030966552858356,
			0.3698077714813633,
			0.397448738371342,
			0.19818030469446093,
			0.494905458122865,
			0.8596370574506895,
			1.0293005439305947,
			1.1108319657377614,
			1.0946402062111644,
			1.0458820148182149,
			0.9665178812009345,
			0.9311737225751053,
			0.902607062285143,
			0.8695718204588478,
			0.8619225940844112,
			0.8711000442458761,
			0.8779120806077668,
			0.9547565143844918,
			1.0151080938318753,
			1.0915160197380114,
			0.9755750330887013,
			0.7767745112570932,
			0.39751829696915403,
			0.4736591971459608,
			1.0668999494521147,
			1.4554290061899309,
			1.4268470818610977,
			1.3914350599227119,
			1.5241555550649608,
			1.259560759828924,
			1.2812249421262465,
			1.24446951847715,
			1.2397032186471098,
			1.204958664927052,
			1.2343732870328392,
			1.1698311597162625,
			1.4987159471212825,
			1.2590622599954193,
			1.4383838776025553,
			1.3692418688879844,
			0.9400215339563518,
			0.3724236280610074,
			0.5116403950040022,
			1.1484367387939973,
			1.540575063537692,
			1.666594927690976,
			1.2925510539538996,
			1.3332604187318908,
			1.2407852594189281,
			1.2211799121829547,
			1.191095323915493,
			1.262739455440069,
			1.172841420460548,
			1.1571958596379086,
			1.170577732193065,
			1.2611099749546957,
			1.1523327373883312,
			1.4343776175877212,
			1.357559350735994,
			1.0232252892687104,
			0.40548156253808987,
			0.515506695337701,
			1.1262687290965685,
			1.339702449769806,
			1.2446194242515858,
			1.1230045160582176,
			1.195667410728894,
			1.1291598097784783,
			1.1103738037874555,
			1.0779009693932895,
			1.054841162710646,
			1.0453078696247244,
			1.0503149024698348,
			1.0446746579209474,
			1.1230177327703283,
			1.0186604144021774,
			1.2102391909091095,
			1.2987316171136212,
			1.011103037370773,
			0.40416679437671227,
			0.5021748115549356,
			1.0621070902068692,
			1.5087504084942063,
			1.3598394383814658,
			1.1902701611407691,
			1.1031482862919804,
			1.07982587165544,
			1.0454847767196285,
			1.0214510729610784,
			1.0022413148230964,
			0.9938591854105346,
			0.9887845899550503,
			0.995425484384913,
			1.0153351724933235,
			1.0929906897015773,
			1.2788669758341433,
			1.4664718628635662,
			0.9572123647067798,
			0.39042324628291375,
			0.46463256917841,
			0.9817039373125364,
			1.2904781912339838,
			1.244143237639479,
			1.1284070515628417,
			1.0829584280878237,
			1.0448149170886447,
			1.0175031978769427,
			0.9811163091526739,
			0.9577954139945161,
			0.9506602391484908,
			0.9580858574140817,
			0.9514589485826475,
			0.9877563369118458,
			1.0281155427199202,
			1.1621043204926667,
			1.172177991658482,
			0.8775939183812063,
			0.36597777532372383,
			0.4645666254881494,
			0.9520063990315454,
			1.3030188362611033,
			1.221837072220455,
			1.1130243000591769,
			1.052807234547356,
			1.0136481450378105,
			0.9880055702324693,
			0.9612482840216627,
			0.941929960517804,
			0.9262766478585833,
			0.925113183844911,
			0.9302875765860227,
			0.9578934211522818,
			1.0212936173843858,
			1.138960727227453,
			1.2137131462616468,
			0.8611032657641075,
			0.3580972116032357,
			0.4116641223674629,
			0.9293371292369893,
			1.2579149082579189,
			1.1989083549466901,
			1.0874361410604914,
			1.0316163560457647,
			0.9843779644937591,
			0.9605552373264569,
			0.9382887290898766,
			0.9247401371342376,
			0.9143347133773572,
			0.9230900137380719,
			0.9169269934174161,
			0.9446505799086047,
			1.0046419503670594,
			1.1213532909200823,
			1.187182516186967,
			0.8425838159086375,
			0.3406115324050917,
			0.39087599151785946,
			0.9128980984871222,
			1.288179089423959,
			1.2870657427979175,
			1.0708351329589536,
			1.0049081376171052,
			0.9666017102322872,
			0.9439044610578738,
			0.9251277231095505,
			1.0118376887713798,
			0.9215663468124196,
			0.9240063727699275,
			0.9239130015955106,
			0.9448832248339897,
			0.9976485710530016,
			1.2281761914093852,
			1.1900023550089216,
			0.8471169361742699,
			0.3453241636289293,
			0.3842710089636857,
			0.9097609951046771,
			1.2462506558675739,
			1.190473625447452,
			1.0682108785273898,
			0.9962457661289255,
			0.9646166935883328,
			0.9363861191657874,
			0.9256126778084665,
			0.9199576431941149,
			0.916723695614344,
			0.916255848334523,
			0.9210414806846057,
			0.93679511630954,
			0.993855426048172,
			1.121446777035981,
			1.1784250526682596,
			0.8377351210617797,
			0.3442434826130679,
			0.3972297723320044,
			0.9118742067381311,
			1.2625818949972598,
			1.199900008864036,
			1.075179875702613,
			1.0089888153772317,
			0.9661336147093477,
			0.9410744484501153,
			0.9273697371766396,
			0.9376663618380845,
			0.9198357309161377,
			0.9091404690172007,
			0.9254595933374756,
			0.9458357256393788,
			1.012866043294489,
			1.1223666541509676,
			1.204181671670226,
			0.8570401461344364,
			0.35705609500924185,
			0.38474081962884754,
			0.9197578349414168,
			1.2067341203543378,
			1.1989091371000027,
			1.068052949610619,
			1.0189583853280006,
			0.9745760218015587,
			0.9453336341769237,
			0.9286933017789506,
			0.9314070279766223,
			0.9247679596446435,
			0.9255962782425957,
			0.9366753485749103,
			0.9744084504653968,
			1.0203358230934212,
			1.1484821700087797,
			1.1597001236485662,
			0.8784377804479064,
			0.350845039934601,
			0.4116209467456973,
			0.9728307695474759,
			1.4580063033812911,
			1.2936377524370917,
			1.1347385261448182,
			1.0355467475633127,
			1.0066714113672453,
			0.9704377882649791,
			0.9514133494268362,
			0.9580429442036102,
			0.9467342939627406,
			0.946465786782983,
			0.9723932023484118,
			1.0053502807441137,
			1.0942797756531077,
			1.2617709216784119,
			1.47991717693717,
			0.9509102276378373,
			0.39481120114375007,
			0.4213727696607661,
			1.032396827655165,
			1.3121079820929493,
			1.2555857623555498,
			1.0491539022346195,
			1.1236326011117064,
			1.0527863029999258,
			1.034812800852434,
			1.0085022711462175,
			1.018360241275427,
			1.0061903431068542,
			1.018724534623019,
			1.0258132239172455,
			1.1125130311763776,
			1.0080849840402228,
			1.1883104088389855,
			1.2787310651283041,
			1.0011911886711586,
			0.38539623896160047,
			0.4157623825752901,
			1.0561614270352029,
			1.432274981856869,
			1.3852828794149044,
			1.188235081602949,
			1.273034331914779,
			1.180225737339391,
			1.1386738022617777,
			1.129124241855335,
			1.2468157404870623,
			1.146742929785027,
			1.134462221802612,
			1.1598648257600295,
			1.2710559046542371,
			1.1644807419336392,
			1.57247052573819,
			1.3635030525478022,
			1.0261871792756645,
			0.38918230491345546,
			0.3834240596016571,
			0.9672670821554195,
			1.3752310533772416,
			1.4534681627390162,
			1.2910147132858196,
			1.4433749970055716,
			1.1877082246569273,
			1.2096676304288605,
			1.1806150076211361,
			1.2128882465228745,
			1.168976786156672,
			1.2108311378453314,
			1.1717670998758627,
			1.4981335127902384,
			1.2752639753882853,
			1.3863106813672703,
			1.3606304363876711,
			0.9404557787032635,
			0.3532516811965178,
			0.41148202791065713,
			0.8044103619059287,
			0.9878025278382379,
			1.0441570745367934,
			1.0258538020813315,
			0.9575412094727301,
			0.8792890644552459,
			0.8516743747200112,
			0.8314943160446739,
			0.8385296500610739,
			0.8308778871559747,
			0.8457758045848692,
			0.8662176837450632,
			0.9537796177308271,
			1.0158422719525082,
			1.0615116994553415,
			0.9536793441674675,
			0.7607546433255379,
			0.38897164350890356,
			0.1982775025799392,
			0.4110027504249708,
			0.3711221500006386,
			0.4171427863510229,
			0.4225524327243327,
			0.3979348040995454,
			0.35570127600498436,
			0.35637018142712007,
			0.33026493927081224,
			0.3413283852991064,
			0.3265687461848932,
			0.3449335460324009,
			0.3561448429718721,
			0.39064872806349876,
			0.39990455940181613,
			0.39347358903653307,
			0.3453265396900468,
			0.38465097162531897,
			0.18161601092863
	});
	// I'm getting paid by LoC, right? 

	@Override
	public GobanValuesD evaluate(Goban gb, int state) {
		GobanValuesD gvd = new GobanValuesD(Arrays.copyOf(MAP.getState(), MAP.getState().length));
		
		if (state == 0)
			return gvd;
		
		// encourage tenuki
		for (int x = 0; x < Goban.WIDTH; x++) {
			for (int y = 0; y < Goban.HEIGHT; y++) {
				if (gb.getState(x, y) == -state) {
					final int radius = 2;
					for (int dx = Math.max(0, x - radius); dx < Math.min(Goban.WIDTH, x + radius); dx++) {
						for (int dy = Math.max(0, y - radius); dy < Math.min(Goban.HEIGHT, y + radius); dy++) {
							double d = gvd.getState(dx, dy);
							d *= 1.01;

							gvd.setState(dx, dy, d);
						}
					}
				}
			}
		}
		return gvd;
	}

}
